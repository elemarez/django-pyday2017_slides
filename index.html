<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta name="description" content="PyDay TF 2017 - Python/Django">
        <meta name="author" content="Elena M. Marrero Méndez">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<title>PyDayTF 2017 - Python/Django</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/solarized.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<!--link rel="stylesheet" href="lib/css/zenburn.css"-->
		<link rel="stylesheet" href="lib/css/tomorrow.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

				<section data-background="images/djangopony.png" data-background-size="600px" data-state="img-right-bottom">
                    <h1>Python/Django</h1>
                    <h3>Elena Marrero Méndez</h4>
                    <p>
                        <small>#PyDayTF 11/03/2017</small>
                    </p>
                </section>

                <section>
                    <h2>RoadMap</h2>
                    <ul>
                        <li>Preparación del entorno</li>
                        <li>Filosofía de Django</li>
                        <li>Crear Proyecto</li>
                        <li>Configuración</li>
                        <li>Requisitos</li>
                        <li>Modelos</li>
                        <li>Interfaz Administrativa</li>
                        <li>Vistas</li>
                        <li>Templates</li>
                    </ul>
                </section>

                <section>
                    <h2>Preparación del entorno (I)</h2>
                    <h3>Tecnologías a utilizar</h3>
                    <ul>
                        <li>python 3.6</li>
                        <li>django 1.10</li>
                        <li>virtualenv</li>
                        <li>pip</li>
                    </ul>
                    <br/>

                    <!--h3>Editores recomendados</h3>
                    <ul>
                        <li>pycharm</li>
                        <li>Aptana</li>
                        <li>Sublime text</li>
                    </ul-->
                </section>
                <section data-transition="slide" data-background-color="darkgreen" data-background-transition="zoom">
                    <h2>Ejercicio 1</h2>
                              <p>Utilizando las herramientas mencionadas, preparar un entorno de trabajo
                                  para nuestro proyecto django</p>
                </section>
                <section>
                    <h2>Preparación del entorno (II)</h2>
                    <h3>virtualenv</h3>
                    <pre><code class="bash" data-trim contenteditable>
$ sudo apt-get install -y python-pip
$ sudo -H pip install virtualenv -U
$ virtualenv myvenv -p python3.6
                    </code></pre>
                    <h4>Trabajando en nuestro virtualenv</h4>
                    <p>Aislamiento de todas las dependencias</p>
                    <pre><code class="bash" data-trim contenteditable>
$ . myvenv/bin/activate
(myvenv)$ pip install django
                    </code></pre>
                    <p>Chequear la versión de django (1.10.6) </p>
                    <pre><code class="bash" data-trim contenteditable>
(myvenv)$ python -c "import django; print(django.get_version())"
                    </code></pre>
                </section>

                <section>
                    <video data-autoplay src="https://youtu.be/1kWjU7yl5ak"></video>
                </section>

                <section><div width="100%">
                   <iframe width="1280" height="720" src="https://www.youtube.com/embed/1kWjU7yl5ak?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>
                </div>
                </section>

                <section>
                    <h2>Filosofía de Django</h2>
                    <blockquote cite="https://www.djangoproject.com/">
                        Django is a high-level Python Web framework that encourages rapid development and clean,
                        pragmatic design
                    </blockquote>
                    <ul>
                        <li class="fragment"> Ridículamente rápido </li>
                        <li class="fragment"> Tranquilizador y seguro </li>
                        <li class="fragment"> Excesivamente escalable </li>
                        <li class="fragment"> Increíblemente versátil </li>
                        <li class="fragment"> <strong> Sigue el principio DRY <br />(Don't Repeat Yourself) </strong></li>
                    </ul>
                </section>
                <section>
                    <h2>Filosofía de Django (II) </h2>
                    <p> Recibe su nombre de Django Reinhardt y la "D" es muda. </p>
                </section>
                <section>
                    <h2>Filosofía de Django (III)</h2>
                    <div id="left">
                    <img width="80%" data-src="images/mvt.png" alt="Model-View-Template">
                    </div>
                    <div id="right">
                        <h3>Model-View-Template</h3>
                        <ul>
                            <li>¿Cómo se almacena un dato? <strong class="fragment">Model</strong></li>
                            <li>¿Qué dato se muestra? <strong class="fragment">View</strong></li>
                            <li>¿Cómo se representa un dato? <strong class="fragment">Template</strong></li>
                        </ul>
                        <h3>Object-Relational Mapper</h3>
                    </div>
                </section>
                <section>
                    <h2>Filosofía de Django (IV)</h2>
                    <strong>Garantiza la modularidad y reusabilidad</strong>
                    <div class="fragment">
                    <h3>Proyecto (project)</h3>
                    <p>Configuración y aplicaciones de un sitio web</p>
                    </div>
                    <div class="fragment">
                    <h3>Aplicación (app)</h3>
                    <p>Aplicación web que cumple una funcionalidad</p>
                    </div>
                </section>
                <section class="example" data-transition="slide" data-background-color="darkgreen" data-background-transition="zoom">
                    <h2>Ejercicio 2</h2>
                    <p> <h3>Gestor de eventos</h3><br/>Crear la estructura de un proyecto django al que llamaremos <code>django_pyday2017</code>
                        y configurarlo</p>

                </section>
                <section>
                    <h2>Crear Proyecto</h2>
                    <pre><code class="bash" data-trim contenteditable>
(myvenv)$ django-admin startproject django_pyday2017
                    </code></pre>
                    <h4>Estructura de directorios</h4>
                    <pre><code class="bash" data-trim contenteditable>
django_pyday2017
├─── manage.py           - python manage.py (no tocar)
└─── django_pyday2017
        settings.py      - Configuración del proyecto
        urls.py          - Asociar URLs a vistas
        wsgi.py          - Servidor wsgi (no tocar)
        __init__.py      - Paquete (no tocar)
                    </code></pre>
                </section>

                <section>
                    <h2>Crear Proyecto (II)</h2>
                     <p><code>settings.py</code> contiene la configuración del sitio web</p>
                    <pre><code class="python" data-trim contenteditable>
ALLOWED_HOSTS = ['*', ]
...
TIME_ZONE = 'Atlantic/Canary'  # Zona Horaria
LANGUAGE_CODE = 'es'  # Código de Idioma
...
STATIC_URL = '/static/'
STATIC_ROOT = 'collected_static'
STATICFILES_DIRS = [
    os.path.join(BASE_DIR, "static"),
]
                    </code></pre>

                    <p><small><a target="_blank" href="https://docs.djangoproject.com/en/1.10/ref/settings/">https://docs.djangoproject.com/en/1.10/ref/settings/</a></small></p>
                </section>

                 <section>
                     <h2>Crear Proyecto (III)</h2>
                     <p>Gran variedad de opciones de bases de datos: PostgreSQL, MySQL, SQLite, Oracle, ...</p>
                    <pre><code class="python" data-trim contenteditable>
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': 'mydatabase',
    }
}
                    </code></pre>
                    <h4>Creación de la Base de Datos</h4>
                    <pre><code class="bash" data-trim contenteditable>
(myvenv)$ python manage.py migrate
                    </code></pre>
                    <p><small><a target="_blank" href="https://docs.djangoproject.com/en/1.10/ref/settings/#databases">https://docs.djangoproject.com/en/1.10/ref/settings/#databases</a></small></p>
                </section>

                <section>
                     <h2>Crear Proyecto (IV)</h2>
                     <p>Para servir los ficheros estáticos necesitamos añadir una nueva url en el fichero <code>urls.py</code></p>
                     <pre><code class="python" data-trim contenteditable>
from django.conf import settings as st
from django.conf.urls.static import static

urlpatterns = [
    # ... resto de tus URLs ...
] + static(st.STATIC_URL, document_root=st.STATIC_ROOT)
                    </code></pre>
                    <p><small><a target="_blank" href="https://docs.djangoproject.com/en/1.10/ref/urls/">https://docs.djangoproject.com/en/1.10/ref/urls/</a></small></p>
                    <h4>Recolectar los archivos estáticos</h4>
                    <pre><code class="bash" data-trim contenteditable>
(myvenv)$ python manage.py collectstatic
                    </code></pre>
                </section>



                <section>
                    <h2>Lanzar el Servidor de Desarrollo</h2>
                    <pre><code class="bash" data-trim contenteditable>
(myvenv)$ python manage.py runserver
                    </code></pre>
                    <p>Verifica que tu sitio web está corriendo</p>
                    <p><a target="_blank" href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a></p>
                </section>

                <section>
                    <h2>Fichero de requisitos</h2>
                                        <code>requirements.txt</code> contiene todos los paquetes que serán necesarios para el proyecto

                    <div id="left">
                    <pre><code class="bash" data-trim contenteditable>
.
├── db.sqlite3
├── django_pyday2017
│   ...
├── manage.py
└── requirements.txt
                    </code></pre>
                    </div>
                    <div id="right">
                    <pre><code class="bash" data-trim contenteditable>
django < 1.11
Werkzeug
django-extensions
Pillow
django-localflavor
django-crispy-forms
                    </code></pre>
                    </div>
                    <h4>Lanzar la instalación de requisitos</h4>
                    <pre><code class="bash" data-trim contenteditable>
(myvenv)$ pip install -Ur requirements.txt
                    </code></pre>
                </section>
                <section data-transition="slide" data-background-color="darkgreen" data-background-transition="zoom">
                    <h2>Ejercicio 3</h2>
                    <h3>Añadir el módulo django-extensions</h3>
                    <p> Extensión de comandos propios del manage.py </p>
                    <p><small><a target="_blank" href="https://django-extensions.readthedocs.io/en/latest/installation_instructions.html">https://django-extensions.readthedocs.io/en/latest/installation_instructions.html</a></small></p>
                </section>
                <section>
                    <h2>Añadir el módulo django-extensions</h2>
                    <ul>
                        <li>Añadirlo al <code>requirements.txt</code> e instalarlo</li>
                        <li>Añadirlo en <code>INSTALLED_APPS</code> en el <code>settings.py</code>
                        <pre><code class="python" data-trim contenteditable>
INSTALLED_APPS = [
    ...,
    'django_extensions',
]
                    </code></pre></li>
                        <li>Actualizar la base de datos<pre><code class="bash" data-trim contenteditable>
(myvenv)$ python manage.py migrate
                    </code></pre>
                        </li>
                    </ul>
                    <p>Arrancamos la aplicación con modo debug integrado</p>
                                        <pre><code class="bash" data-trim contenteditable>
(myvenv)$ python manage.py runserver_plus
                    </code></pre>
                </section>
                <section class="example" data-transition="slide" data-background-color="darkgreen" data-background-transition="zoom">
                    <h2>Ejercicio 4</h2>
                    <div id="left">
                                            <h3>Gestor de eventos</h3>

                    <p>Crear una aplicación en django llamada <code>events</code> que
                    servirá para gestionar y publicar un listado de próximos eventos, así como para gestionar las
                    inscripciones a los mismos.</p>
                    </div>
                    <div id="right">
                    <img height="80%" data-src="images/diagrama_events.png" alt="Model-View-Template">
                    </div>
                </section>

                 <section>
                    <h2>Crear Aplicación</h2>
                    <pre><code class="bash" data-trim contenteditable>
(myvenv)$ django-admin startapp events
                    </code></pre>
                     <p>Añadir la aplicación en <code>INSTALLED_APPS</code> en el <code>settings.py</code></p>
                 </section>
                <section>
                    <h2>Crear Aplicación (II)</h2>
                    <h4>Estructura de directorios</h4>
                    <pre><code class="bash" data-trim contenteditable>
.
├── db.sqlite3
├── django_pyday2017
│   ...
├── events
│   ├── admin.py         - Interfaz administrativa
│   ├── apps.py          - Configuración de la aplicación
│   ├── __init__.py
│   ├── migrations       - Migraciones de la BBDD
│   │   └── __init__.py
│   ├── models.py        - Definición de la BBDD
│   ├── tests.py         - Tests
│   └── views.py         - Gestión de los datos
├── manage.py
└── requirements.txt
                    </code></pre>
                </section>
                <section>
                    <h2>Modelos</h2>
                    <ul>
                        <li>Crear la definición de los modelos en el archivo <code>models.py</code><br />
                            <small><a target="_blank" href="https://docs.djangoproject.com/es/1.10/ref/models/fields/">https://docs.djangoproject.com/es/1.10/ref/models/fields/</a></small>
                        </li>
                        <li>Generar, ver y aplicar las migraciones de la BBDD respecto a los modelos
                            <pre><code class="bash" data-trim contenteditable>
(myvenv) $ python manage.py makemigrations events
(myvenv) $ python manage.py sqlmigrate events 0001
(myvenv) $ python manage.py migrate
                    </code></pre>
                        </li>
                    </ul>
                </section>
                <section>
                    <h2>Interfaz de administración</h2>
                    <p>Crear un superusuario <pre><code class="bash" data-trim contenteditable>
(myvenv) $ python manage.py createsuperuser
Username (leave blank to use 'pyday'): admin
Email address: a@a.es
Password: pyday2017
                </code></pre></p>
                    <p>
                    Registramos los modelos editando <code>admin.py</code>.
                    <pre><code class="python" data-trim contenteditable>
from django.contrib import admin
from .models import Evento, Inscripcion

admin.site.register(Evento)
admin.site.register(Inscripcion)
                    </code></pre>
                </p>
                    <p><a target="_blank" href="http://127.0.0.1:8000/admin">http://127.0.0.1:8000/admin</a></p>
                </section>

                <section>
                    <h2>Object-Relational Mapper (ORM)</h2>
                    <p>API que permite la abstracción de la BBDD:
                    <ul>
                        <li>Crear, modificar y borrar tuplas (objetos)</li>
                        <li>Obtener tuplas (get, filter, all)</li>
                        <li>Contar, ordenar, ...</li>
                    </ul></p>
                    <p>
                        Abrimos una shell interactiva del proyecto y empezamos a jugar
                    <pre><code class="bash" data-trim contenteditable>
(myvenv) $ python manage.py shell_plus
                </code></pre></p>
                    <p><small><a target="_blank" href="https://docs.djangoproject.com/en/1.10/topics/db/queries/">https://docs.djangoproject.com/en/1.10/topics/db/queries/</a></small></p>
                </section>


                <section data-transition="slide" data-background-color="darkgreen" data-background-transition="zoom">
                    <h2>Ejercicio 5</h2>
                    <h3>Gestor de eventos</h3>
                    <h4>Añadir funcionalidad a la Interfaz Administrativa</h4>
                    <p><small><a target="_blank" href="https://django-extensions.readthedocs.io/en/latest/installation_instructions.html">https://django-extensions.readthedocs.io/en/latest/installation_instructions.html</a></small></p>
                    <ul>
                        <li> Añadir el número de inscritos en un evento </li>
                        <li> Añadir inscripciones desde el propio evento </li>
                        <li> Añadir un filtro lateral </li>
                        <li> Publicar eventos de forma masiva </li>
                        <li>...</li>
                    </ul>
                </section>

                <section>
                    <h2>Interfaz pública</h2>
                    <div id="left">
                    <img width="80%" data-src="images/mvt.png" alt="Model-View-Template">
                    </div>
                    <div id="right">
                        <h3> Ciclo de desarrollo habitual:</h3>
                     <ul>
                         <li>URL</li>
                         <li>View</li>
                         <li>Template</li>
                     </ul>
                    </div>
                </section>

                <section>
                    <h2>Interfaz pública (II)</h2>
                    <h3>URLs</h3>
                    <p>Añadir nuestra aplicación al <code>urls.py</code> general
                                        <pre><code class="python" data-trim contenteditable>
from django.conf.urls import url

urlpatterns = [
    ...
    url(r'^evento/', include('events.urls')),
    ...
]
                    </code></pre>
                    </p>
                    <p>
                    En el específico, definir una por cada acción que se quiera realizar.
                    <pre><code class="python" data-trim contenteditable>
url(r'^(?P&ltevento_id&gt\d+)/$', views.detalle, name='detalle'),
                </code></pre>

                    </p>
                </section>

                <section>
                    <h2>Vistas genéricas</h2>
                    <blockquote>Las vistas genéricas abstraen los patrones comunes hasta el punto en que ni
                        siquiera es necesario escribir código Python para escribir una aplicación.</blockquote>
                    <img width="100%" data-src="images/generic_views.png" alt="Generic Views">
                    <p><small><a target="_blank" href="https://docs.djangoproject.com/en/1.10/ref/class-based-views/">
                        https://docs.djangoproject.com/en/1.10/ref/class-based-views/
                        </a></small></p>
                </section>

                <section>
                    <h2>Plantillas</h2>
                    <p>Creación del directorio <code>templates</code> en la raíz del proyecto y un subdirectorio por cada aplicación.</p>
                    <pre><code class="bash" data-trim contenteditable>
.
├── events
|   ...
├── manage.py
├── requirements.txt
├── static
│   ...
└── templates
    ├── base.html             - Genérica con bloques definidos
    └── events
        ├── ..._detail.html   - Extienden de base y rellenan
        └── ..._form.html         los bloques
                    </code></pre>
                    <p><small><a target="_blank" href="https://docs.djangoproject.com/en/1.10/ref/templates/language/">
                        https://docs.djangoproject.com/en/1.10/ref/templates/language/
                        </a></small></p>
                </section>

                <section data-transition="slide" data-background-color="darkgreen" data-background-transition="zoom">
                    <h2>Ejercicio 6</h2>
                    <h3>Gestor de eventos</h3>
                    <h4>Añadir la siguiente funcionalidad pública</h4>
                    <ul>
                        <li> Listado de los eventos públicos </li>
                        <li> Detalle de un evento en particular </li>
                        <li> Inscripción en un evento accesible desde el detalle y desde el listado </li>
                        <li> Detalle de la inscripción </li>
                        <li>...</li>
                    </ul>
                </section>












				<section data-background="images/djangopony.png" data-background-size="600px" data-state="img-right-bottom">
                    <h1>Gracias!</h1>
                    <h3>Elena Marrero Méndez</h4>
                    <p>
                        <small>#PyDayTF 11/03/2017</small>
                    </p>
                </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
                controls: true,
                progress: true,
				history: true,
                center: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true }
                ]
			});
		</script>
	</body>
</html>
